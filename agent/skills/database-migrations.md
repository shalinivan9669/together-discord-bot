# Database Migrations Skill

## Цель

Развивать схему БД без риска поломки прод-данных и откатов поведения.

## Do

- Добавлять только forward-only SQL migration файлы.
- Синхронизировать SQL миграции с Drizzle schema.
- Заранее закладывать уникальные ограничения для dedupe-критичных flow.
- Делать seed-скрипты idempotent (upsert/re-runnable).
- Для долгоживущих сценариев хранить явные status/step/timestamp поля.

## Don't

- Не редактировать миграции, которые уже применялись в проде.
- Не добавлять таблицы интеракций без индексов на hot-path выборки.
- Не переносить ответственность за целостность только на код приложения.

## Мини-чеклист

- Есть PK и необходимые UNIQUE.
- Есть индексы для частых WHERE/JOIN.
- Есть nullable-стратегия для backfill.
- Есть план обратной совместимости для старого кода (если нужно).
